Topic_no,Keywords,Contrib,System,Text
6,"commit, merge, ad, array, buffer, change, remove, reset, call, bug, state, boringssl, instance, exception, enable, root_date, pass, bad, give, track",0.0816,conscrypt,AI 144418: am: CL 144381 am: CL 144356 Synchronized code that touches native SSL sessions. Original author: crazybob Merged from: //branches/cupcake/... Original author: android-build Automated import of CL 144418/auto import from
,,0.0873,conscrypt,AI 144381: am: CL 144356 Synchronized code that touches native SSL sessions. Original author: crazybob Merged from: //branches/cupcake/... Automated import of CL 144381/auto import from
,,0.28,conscrypt,"Keep enough state to completely reset cipher instances OpenSSLs RC4 mutates the given key. AES/CTR mutates the IV. We must store these values locally to enable ""doFinal"" to cause the Cipher instance to be reset to what it was right after ""init"". Note that resetting and encrypting with the same key or IV breaks semantic security. Bug: 16298401 Bug: Change-Id: Ie7e4dcb6cf6cc33ddad31d6b47066dc1b34e6894/"
,,0.1602,conscrypt,"Validate hostname is usable for SNI According to RFC 6066 section 3, the hostname listed in the Server Name Indication (SNI) field is a fully qualified domain name and IP addresses are not permitted. Bug: 16658420 Bug: 17059757 Change-Id: I804e46b6e66599b2770f0f4f0534467987e51208/"
,,0.1443,conscrypt,"Read property to enable SNI Read the system property ""jsse.enableSNIExtension"" on whether to enable Server Name Indication (SNI) extension. For unbundled builds, this will be enabled by default. For platform builds, this will be disabled by default. Bug: 16658420 Bug: 17059757 Change-Id: I774f5406bf3fe601a42c4ef5e708b31800147eb9/"
,,0.5226,conscrypt,"OpenSSLEngineImpl: reduce number of copies needed When the ByteBuffer didnt line up exactly with the backing array, it would allocate a new buffer to write into. Instead, add the ability for OpenSSL to read at an offset in the given array so a copy isnt needed. Change-Id: I149d3f94e4b5cbdc010df80439ae3300cbdc87a5/OpenSSLSocketImpl: Move state checks inside mutex Checking the state of the connection is unreliable if SSL_read and SSL_write are happening in another thread. Move the state checks inside our application mutex so we dont run into another thread mutating the state at the same time. Bug: 15606096 Change-Id: I5ecdeb1551a13098d1b66c5e4009607c9951fa38/Revert ""Revert ""Automatic management of OpenSSL error stack"""" The ""else"" statement in OpenSslError::reset wasnt properly resetting the error state which made a second call into sslRead jump into sslSelect when it should have just returned immediately. Change-Id: I22e8025c0497a04e78daa07cef78191a6ca1a70c/Fix debugging with unbundled conscrypt When JNI_TRACE was enabled, there were missing defines for the debugging code since no platform code is included. Also clang complains about more of the debugging statement formats, so we have to move some things around to get it to be happy. Change-Id: I1a6695c2ef2639cc01cfc3d3a8603f010c659844/Revert ""Automatic management of OpenSSL error stack"" This reverts commit 35666e4cb0fcd063a21d17eebbb571b4e4e822b8. Change-Id: I926d159c4c4b99250caef750732976c1e601e9ef/Automatic management of OpenSSL error stack This removes some complexity in remembering to free the OpenSSL error stack. If you forget, the error will stick around until you make another call. Change-Id: I245a525dcc93077b2bf9909a14a0ef469a2daca4/Fix some JNI_TRACE lines During debugging these would be enabled, but they were copy-pastad to with the wrong args. Change-Id: I23f39ff4807e3fa71f3220912aec3c99db6b9454/"
,,0.2311,conscrypt,"Add support for TLS_FALLBACK_SCSV (cherry picked from commit 8d7e23e117da591a8d48e6bcda9ed6f58ff1a375) Bug: 17750026 Change-Id: Iaf437ce2bc2b0ae86bb90a67e6e5378b25ae0a81/Add support for TLS_FALLBACK_SCSV Bug: 17750026 Change-Id: I1c2ecbeb914db645f440d58e7f7daa86d880ad6f/OpenSSLEngineImpl: reduce number of copies needed When the ByteBuffer didnt line up exactly with the backing array, it would allocate a new buffer to write into. Instead, add the ability for OpenSSL to read at an offset in the given array so a copy isnt needed. Change-Id: I149d3f94e4b5cbdc010df80439ae3300cbdc87a5/"
,,0.2128,conscrypt,"OpenSSLEngineImpl: reduce number of copies needed When the ByteBuffer didnt line up exactly with the backing array, it would allocate a new buffer to write into. Instead, add the ability for OpenSSL to read at an offset in the given array so a copy isnt needed. Change-Id: I149d3f94e4b5cbdc010df80439ae3300cbdc87a5/"
,,0.2693,conscrypt,"Implement write socket timeouts for unbundled apps Change-Id: I4fd604f057ba4288d4f31bf6b3b93307376023d5/Tracking change from AOSP Change-Id: I889af3f7c1de9ef34d9328339e1b421651055ad4/Rename hostname fields and methods to reflect usage The hostname that was supplied when the socket was created is stored as the ""peerHostname"" This is the only one that should be used for Server Name Indication (SNI) purposes. The ""peerHostname"" or the resolved IP address may be used for certificate validation, so keep the use of ""getHostname()"" for cerificate validation. Bug: 16658420 Bug: 17059757 Change-Id: Ifd87dead44fb2f00bbfd5eac7e69fb3fc98e94b4/Use consistent naming for SSLSocket arguments This changes all the host to be hostname and anything that takes an InetAddress will have the name of address to avoid confusing it with a hostname. Bug: 16658420 Bug: 17059757 Change-Id: Iac0628d2d156023dbb80c2e636af6bfe63f46650/"
,,0.2041,conscrypt,"Switch EVP_CIPHER_CTX to new style Bug: 16656908 Change-Id: Id519c20474a02c70e72d362bc84d26855a74fa33/Convert EVP_PKEY to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. This pass fixes EVP_PKEY references, but more passes are needed. Bug: 16656908 Change-Id: I5925da40cb37cd328b3a126404944f771732a43e/Allow conscrypt to work with BoringSSL. This is quite a substantial change because of the changes to ENGINEs in BoringSSL. For the most part, are used to allow the code to work with either OpenSSL or BoringSSL. However, in several places, support for things that BoringSSL is dropping have been removed, even when OpenSSL is used. This includes DSA keys and tests for the ENGINE bits that are going away because its unclear how to skip compiling those tests. Change-Id: I941a5ed232391f84b45e070c19d2ffb7ad162b7b/Remove support for DSS TLS/SSL cipher suites. This is in preparation for migration from OpenSSL to BoringSSL. BoringSSL does not support DSS. DSS cipher suites are used by a vanishingly tiny fraction of the Android ecosystem. In all cases, the servers SSL certificate is self-signed (rather than CA issued), making it easy to switch to a new self-signed certificate which is based on RSA or ECDSA. Bug: 17409664 Change-Id: I91067ca9df764edd2b7820e5dec995f24f3910a1/Fix null elements in X509KeyManager.chooseClientAlias keyTypes. This fixes an issue where client certificate types requested by the server from the client, but not known by the client, manifest themselves as null elements in X509KeyManager.chooseClientAlias keyTypes argument. The root cause was that for each element in the CertificateRequest.certificate_types array an element was output into the keyTypes array. For unknown values of certificate_type, a null was output. This CL fixes the issue by ignoring unknown values in certificate_types array. Bug: 18414726 Change-Id: I8565e19a610c0ecfb7cab1b7707c335e0eeb8d89/"
,,0.8413,conscrypt,"Treat SSL_ERROR_ZERO_RETURN correctly. According to ssl_lib.c, this is returned whenever the socket is being closed (s->shutdown && SSL_RECEIVED_SHUTDOWN && s->s3->warn_alert SSL_AD_CLOSE_NOTIFY). Change-Id: Ied7b3e18f11786351d42a770f4cad11ddae29ff3/Go back to BIO_s_null instead of empty mem buf If you pass NULL to BIO_new_mem_buf, it adds an error to the stack and returns NULL instead of an actual BIO. Go back to BIO_s_null instead. Bug: 18870062 Change-Id: Idba61a90907fbc2ea3528734b8cc9e27eccb1b50/external/conscrypt: sync to latest BoringSSL. This change tweaks one thing because of changes to BoringSSL: RSA methods now have a |supports_digest| member. It also updates several bits of code in order to work with the recently added Change-Id: I1d1ad80b3471fbbe6fcc259e659e425d8129ace5/Clear SSL state safely Since SSL_clear can fail, we should clear the OpenSSL ERR stack if it does fail. However, to aid in spotting bugs, only clear the stack if the SSL_clear itself fails. (cherry picked from commit 86dd832ac26112890b3e815a144ff062ae9b3559) Bug: 18570895 Change-Id: I053d2e2792e64923c1e128b4fcae23b2e660a992/Clear SSL state safely Since SSL_clear can fail, we should clear the OpenSSL ERR stack if it does fail. However, to aid in spotting bugs, only clear the stack if the SSL_clear itself fails. Bug: 18570895 Change-Id: I053d2e2792e64923c1e128b4fcae23b2e660a992/Convert EC_GROUP and EC_POINT to new style Bug: 16656908 Change-Id: Ie912f376f69327ce634cac50763bf86b418049f5/Restore EVP_CIPHER_CTX_set_key_length During the compatibility with BoringSSL change, this appears accidentally removed without removing any of the references from NativeCrypto.java or OpenSSLCipher.java Change-Id: I7fe686b367994f127675b076ab49712767203f49/Convert EVP_PKEY to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. This pass fixes EVP_PKEY references, but more passes are needed. Bug: 16656908 Change-Id: I5925da40cb37cd328b3a126404944f771732a43e/Fix JNI_TRACE The update to BoringSSL broke some of the tracing messages, so fix their formatting to compile correctly with warning on. Change-Id: I6c7a1e0069b61a787d9e00b929a6c4fa4358a063/Convert EVP_MD_CTX to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. Bug: 16656908 Change-Id: I165e041a8fe056770d6ce6d6cd064c411575b7c4/Fix mac build. Change-Id: Ib7297bb0631caafed1ff04bcf2d73aea512c01c1/OpenSSLRandom: restore parts for OpenSSL BoringSSL reads /dev/urandom directly, so these calls arent needed. However, OpenSSL needs these calls in some instances to protect against other things going wrong elsewhere. Restore the previous code until BoringSSL is in the tree. Change-Id: I55624e0d98b04e9f5411f69e13a70a78fa0c0d7f/Allow conscrypt to work with BoringSSL. This is quite a substantial change because of the changes to ENGINEs in BoringSSL. For the most part, are used to allow the code to work with either OpenSSL or BoringSSL. However, in several places, support for things that BoringSSL is dropping have been removed, even when OpenSSL is used. This includes DSA keys and tests for the ENGINE bits that are going away because its unclear how to skip compiling those tests. Change-Id: I941a5ed232391f84b45e070c19d2ffb7ad162b7b/Squashed commit of changes from lmp-ub-dev Contains the following changes: commit e31d982cdb0f8e6ef05d1e412576888015e1da17 Merge: eaebc54 b73be72 Author: Neil Fuller Date: Wed Oct 22 10:34:23 2014 +0000 am b73be72e: am 3e21a289: (-s ours) TLS_FALLBACK_SCSV CTS fix for klp-modular-dev * commit b73be72ed97da8f36450d95d52f485cc6f451c61: TLS_FALLBACK_SCSV CTS fix for klp-modular-dev commit eaebc544f3a10c53d7d2f908514122caba569e14 Merge: 223b5da cd50afa Author: Kenny Root Date: Tue Oct 14 17:30:19 2014 +0000 Merge ""Fix SSLEngine to support session resumption."" into lmp-ub-dev commit 223b5da5d70e47b1a497e86474493925b568f6d7 Merge: 8737796 cb7a360 Author: Neil Fuller Date: Thu Oct 9 14:52:00 2014 +0000 am cb7a3605: am ea961ada: Apply conscrypt changes from merge commit * commit cb7a36050f34d3c16be00d532411820761eeb276: Apply conscrypt changes from merge commit commit cd50afad1567b1311e6e979e94a7167b7bf69c94 Author: Doug Steedman Date: Mon Oct 6 13:16:15 2014 Fix SSLEngine to support session resumption. Bug: 17877118 Change-Id: I388b59cde58fdc506ecac9f536e4bbd9161df6ad commit 8737796a646eaec94df32827752a71aee74bd46f Merge: 9564a5f 8d7e23e Author: Kenny Root Date: Mon Oct 6 22:34:20 2014 +0000 am 8d7e23e1: Add support for TLS_FALLBACK_SCSV * commit 8d7e23e117da591a8d48e6bcda9ed6f58ff1a375: Add support for TLS_FALLBACK_SCSV commit 9564a5fb9ed2eecf6299788db35213cb08397212 Merge: 4f58feb 7640613 Author: Kenny Root Date: Fri Sep 12 17:27:23 2014 +0000 am 76406135: am 6dcb23fe: am f427ec90: Fix the ENGINE_finish/ENGINE_free mixup * commit 76406135cf3a3b88afc979fe8e847b9c3d8b93c1: Fix the ENGINE_finish/ENGINE_free mixup commit 4f58feb0ea49dc089a95efba196032ef3c960a39 Merge: ddac5c6 984b7ec Author: Kenny Root Date: Wed Sep 10 07:07:16 2014 +0000 am 984b7ec6: Fix the ENGINE_finish/ENGINE_free mixup * commit 984b7ec6f5aab314117949a48e448ff4f6b65f16: Fix the ENGINE_finish/ENGINE_free mixup commit ddac5c6d7e413b0d68b388fbdf70dbeb3eeae865 Merge: 5a8ca5b 36ba60b Author: Kenny Root Date: Thu Sep 4 22:41:38 2014 +0000 Merge ""Reset lmp-ub-dev to lmp-dev-plus-aosp"" into lmp-ub-dev commit 36ba60b039f1f30ab1ea8f0e2a4da8ae4e3906e5 Author: Kenny Root Date: Wed Aug 27 12:07:07 2014 Reset lmp-ub-dev to lmp-dev-plus-aosp Bug: 17059757 Change-Id: I581963360da47b574e1e2e20c2851485c36fa62c commit 6a4f2ef9e4ea3ebb321d45ca39b30d634ea3b4ad Merge: 9b187af f67d784 Author: Kenny Root Date: Tue Aug 26 04:17:38 2014 +0000 am f67d784a: Add pre-Honeycomb literal IP matching * commit f67d784abe5cef700240be02c68cecd899cd8e6d: Add pre-Honeycomb literal IP matching commit 9b187af33dcd97915a0371d64fe1ee4aba20d0ba Merge: 714ebea 966ae8a Author: Kenny Root Date: Tue Aug 26 04:17:37 2014 +0000 am 966ae8a6: Read property to enable SNI * commit 966ae8a6e12f3235b1cb041e687bda11b41fe4eb: Read property to enable SNI commit 714ebeabcb5e35c6df6a5c21f549cdb6130368c4 Merge: 7724204 54a1ba4 Author: Kenny Root Date: Tue Aug 26 04:06:54 2014 +0000 Merge ""resolved conflicts for merge of 342097db to lmp-dev-plus-aosp"" into lmp-dev-plus-aosp commit 54a1ba421d23bb6d988688c2662715e509172447 Merge: a20d871 342097d Author: Kenny Root Date: Mon Aug 25 21:03:51 2014 resolved conflicts for merge of 342097db to lmp-dev-plus-aosp Change-Id: I853c6b0d3725dafbdc84c4d6d6d1b90529bd949d commit 7724204abf4431d35787c44c4a22cda5489d4e37 Merge: 20f60ac afb3403 Author: Kenny Root Date: Tue Aug 26 00:09:27 2014 +0000 am afb34034: Implement write socket timeouts for unbundled apps * commit afb340348bfc54dbc46964e159fe803f9c93a4dd: Implement write socket timeouts for unbundled apps commit f67d784abe5cef700240be02c68cecd899cd8e6d Author: Kenny Root Date: Wed Aug 20 14:14:26 2014 Add pre-Honeycomb literal IP matching This will allow us to run this code on Gingerbread devices and others that dont have the InetAddress#isNumeric API. Bug: 16658420 Bug: 17059757 Change-Id: I597d539979d58eeaa2677d6f99e911313a550cc1 commit 966ae8a6e12f3235b1cb041e687bda11b41fe4eb Author: Kenny Root Date: Mon Aug 18 10:12:20 2014 Read property to enable SNI Read the system property ""jsse.enableSNIExtension"" on whether to enable Server Name Indication (SNI) extension. For unbundled builds, this will be enabled by default. For platform builds, this will be disabled by default. Bug: 16658420 Bug: 17059757 Change-Id: I774f5406bf3fe601a42c4ef5e708b31800147eb9 commit 342097db97a9b2736531033b2c4b4d8ce4998c67 Author: Kenny Root Date: Wed Aug 20 12:14:52 2014 Validate hostname is usable for SNI According to RFC 6066 section 3, the hostname listed in the Server Name Indication (SNI) field is a fully qualified domain name and IP addresses are not permitted. Bug: 16658420 Bug: 17059757 Change-Id: I804e46b6e66599b2770f0f4f0534467987e51208 commit afb340348bfc54dbc46964e159fe803f9c93a4dd Author: Kenny Root Date: Tue Aug 19 16:33:07 2014 Implement write socket timeouts for unbundled apps Change-Id: I4fd604f057ba4288d4f31bf6b3b93307376023d5 commit 20f60acea153dfdf0c8f75a53d7bd9edb4c7614c Author: Kenny Root Date: Mon Aug 25 11:52:05 2014 Tracking change from AOSP Change-Id: I889af3f7c1de9ef34d9328339e1b421651055ad4 commit 68056b7c9db8a9fb384bbadfc5287730f996896d Merge: 8239dfd cc2ef2e Author: Kenny Root Date: Mon Aug 25 18:03:27 2014 +0000 am cc2ef2e2: Rename hostname fields and methods to reflect usage * commit cc2ef2e2e9ee64f2e0ac2abc7fdf636e2f81fa5e: Rename hostname fields and methods to reflect usage commit 8239dfdcc40a69255d7b2feced960d574ea36321 Merge: e9cf759 076138f Author: Kenny Root Date: Thu Aug 21 16:36:24 2014 +0000 am 076138ff: Use consistent naming for SSLSocket arguments * commit 076138ff29d805ec5a32d6ad96a18ef08c7f1b11: Use consistent naming for SSLSocket arguments commit cc2ef2e2e9ee64f2e0ac2abc7fdf636e2f81fa5e Author: Kenny Root Date: Wed Aug 20 11:26:33 2014 Rename hostname fields and methods to reflect usage The hostname that was supplied when the socket was created is stored as the ""peerHostname"" This is the only one that should be used for Server Name Indication (SNI) purposes. The ""peerHostname"" or the resolved IP address may be used for certificate validation, so keep the use of ""getHostname()"" for cerificate validation. Bug: 16658420 Bug: 17059757 Change-Id: Ifd87dead44fb2f00bbfd5eac7e69fb3fc98e94b4 commit 076138ff29d805ec5a32d6ad96a18ef08c7f1b11 Author: Kenny Root Date: Wed Aug 20 11:24:41 2014 Use consistent naming for SSLSocket arguments This changes all the host to be hostname and anything that takes an InetAddress will have the name of address to avoid confusing it with a hostname. Bug: 16658420 Bug: 17059757 Change-Id: Iac0628d2d156023dbb80c2e636af6bfe63f46650 commit e9cf759ac89fb053c01f1db19931beb14a823618 Merge: ababdd1 7ed0fae Author: Kenny Root Date: Tue Aug 19 19:32:43 2014 +0000 am 7ed0fae1: OpenSSLEngineImpl: reduce number of copies needed * commit 7ed0fae1906061766d0042e69ccba20e4a702bbe: OpenSSLEngineImpl: reduce number of copies needed commit 7ed0fae1906061766d0042e69ccba20e4a702bbe Author: Kenny Root Date: Tue Jul 22 13:03:09 2014 OpenSSLEngineImpl: reduce number of copies needed When the ByteBuffer didnt line up exactly with the backing array, it would allocate a new buffer to write into. Instead, add the ability for OpenSSL to read at an offset in the given array so a copy isnt needed. Change-Id: I149d3f94e4b5cbdc010df80439ae3300cbdc87a5 commit ababdd1ae1272eac174e3a449a413ab35afbc435 Merge: 66c31e0 4b050b6 Author: Kenny Root Date: Fri Aug 15 16:23:14 2014 +0000 am 4b050b6f: OpenSSLSocketImpl: Move state checks inside mutex * commit 4b050b6fb06fbb804557eecc72cc4ff0e0277525: OpenSSLSocketImpl: Move state checks inside mutex commit 66c31e0b613ceefc167a2e1fb226a14c78f84537 Merge: f4b895a 0931d51 Author: Kenny Root Date: Thu Aug 14 20:46:43 2014 +0000 am 0931d51c: OpenSSLSocketImpl: Move state checks inside mutex * commit 0931d51c58b2dc2f612298f99fbf0fa6ed4c3706: OpenSSLSocketImpl: Move state checks inside mutex commit 0931d51c58b2dc2f612298f99fbf0fa6ed4c3706 Author: Kenny Root Date: Tue Aug 5 15:45:32 2014 OpenSSLSocketImpl: Move state checks inside mutex Checking the state of the connection is unreliable if SSL_read and SSL_write are happening in another thread. Move the state checks inside our application mutex so we dont run into another thread mutating the state at the same time. Bug: 15606096 Change-Id: I5ecdeb1551a13098d1b66c5e4009607c9951fa38 commit f4b895ae9c424b5c2d49c744131606adccbc49d7 Merge: a35c400 a260ee6 Author: Kenny Root Date: Wed Aug 13 15:35:28 2014 +0000 am a260ee6d: Revert ""Revert ""Automatic management of OpenSSL error stack"""" * commit a260ee6d0caea43f8010f158a4a35fb712935ae3: Revert ""Revert ""Automatic management of OpenSSL error stack"""" commit a35c40017c8690f821351d6460dfeaa2738b884c Merge: 0edc483 30550a8 Author: Kenny Root Date: Wed Aug 13 15:35:27 2014 +0000 am 30550a8b: Fix debugging with unbundled conscrypt * commit 30550a8b64bbcd6ca537680a17b8726932a29937: Fix debugging with unbundled conscrypt commit a260ee6d0caea43f8010f158a4a35fb712935ae3 Author: Kenny Root Date: Tue Aug 12 15:38:10 2014 Revert ""Revert ""Automatic management of OpenSSL error stack"""" The ""else"" statement in OpenSslError::reset wasnt properly resetting the error state which made a second call into sslRead jump into sslSelect when it should have just returned immediately. Change-Id: I22e8025c0497a04e78daa07cef78191a6ca1a70c commit 30550a8b64bbcd6ca537680a17b8726932a29937 Author: Kenny Root Date: Tue Aug 12 15:13:33 2014 Fix debugging with unbundled conscrypt When JNI_TRACE was enabled, there were missing defines for the debugging code since no platform code is included. Also clang complains about more of the debugging statement formats, so we have to move some things around to get it to be happy. Change-Id: I1a6695c2ef2639cc01cfc3d3a8603f010c659844 commit 0edc4833091846d6cb45961fc9458df842fbbad9 Merge: 107a8fb 2411b8b Author: Kenny Root Date: Tue Aug 12 21:46:12 2014 +0000 am 2411b8bd: Merge ""Revert ""Automatic management of OpenSSL error stack"""" * commit 2411b8bdcde72c956f4150e9a5909b7501f50bad: Revert ""Automatic management of OpenSSL error stack"" commit 2411b8bdcde72c956f4150e9a5909b7501f50bad Merge: 3262a8c b514d72 Author: Kenny Root Date: Tue Aug 12 21:39:32 2014 +0000 Merge ""Revert ""Automatic management of OpenSSL error stack"""" commit b514d72b93c3996d97e38eca6db1ad684965fd9b Author: Kenny Root Date: Tue Aug 12 21:39:17 2014 +0000 Revert ""Automatic management of OpenSSL error stack"" This reverts commit 35666e4cb0fcd063a21d17eebbb571b4e4e822b8. Change-Id: I926d159c4c4b99250caef750732976c1e601e9ef commit 107a8fba8be5be57933f2638b76ac1243b578b9e Merge: 1de007f 3262a8c Author: Kenny Root Date: Tue Aug 12 15:50:14 2014 +0000 am 3262a8c2: Merge ""Automatic management of OpenSSL error stack"" * commit 3262a8c2741b95103149bcdefe2409c24bfddee9: Automatic management of OpenSSL error stack commit 1de007f9f01be8f07a56235dd924c897088a03cb Merge: 94890ae d1bbcd0 Author: Kenny Root Date: Tue Aug 12 15:50:14 2014 +0000 am d1bbcd0e: Relax checks for key vs cert for wrapped keys * commit d1bbcd0ec973e1b8465c204c13b4925fd86e6484: Relax checks for key vs cert for wrapped keys commit 3262a8c2741b95103149bcdefe2409c24bfddee9 Merge: d1bbcd0 35666e4 Author: Kenny Root Date: Tue Aug 12 15:31:02 2014 +0000 Merge ""Automatic management of OpenSSL error stack"" commit d1bbcd0ec973e1b8465c204c13b4925fd86e6484 Author: Kenny Root Date: Mon Aug 11 14:56:58 2014 Relax checks for key vs cert for wrapped keys If a key is a wrapped platform key, we must relax the check. The reason is that we may not have the public values we need to pass the EVP_PKEY_cmp checks that this does. Change-Id: I7ab2be51b0968a9cf771edea01d33fe2367c8185 commit 35666e4cb0fcd063a21d17eebbb571b4e4e822b8 Author: Kenny Root Date: Tue Aug 5 11:05:00 2014 Automatic management of OpenSSL error stack This removes some complexity in remembering to free the OpenSSL error stack. If you forget, the error will stick around until you make another call. Change-Id: I245a525dcc93077b2bf9909a14a0ef469a2daca4 commit 94890aec5735cde2ea5170fb76cd1b847ea66af8 Merge: 8360485 977f087 Author: Kenny Root Date: Tue Aug 5 16:44:42 2014 +0000 am 977f0877: Fix some JNI_TRACE lines * commit 977f08774c628b4640d5454cde050259856965f8: Fix some JNI_TRACE lines commit 977f08774c628b4640d5454cde050259856965f8 Author: Kenny Root Date: Mon Aug 4 12:15:04 2014 Fix some JNI_TRACE lines During debugging these would be enabled, but they were copy-pastad to with the wrong args. Change-Id: I23f39ff4807e3fa71f3220912aec3c99db6b9454 commit 83604854c5160304cafefc9bd40a72c5ee8506eb Merge: 7db3524 1ffe43e Author: Zoltan Szatmary-Ban Date: Thu Jul 31 13:28:57 2014 +0000 am 1ffe43e8: Merge ""Add possibility to get deleted system Certificate Aliases"" into lmp-dev * commit 1ffe43e8277e883c6663c1fb7cfc5e18ba552c40: Add possibility to get deleted system Certificate Aliases commit 7db3524880092126962b7f502af76b4c84da7350 Merge: 5767d63 ad0cd83 Author: Prameet Shah Date: Wed Jul 30 17:04:13 2014 +0000 am ad0cd830: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() * commit ad0cd83024f38011043d28d70370a8638b88cd72: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() commit 5767d63d22e87becab387b3bd6597fe41eb34d7e Merge: b389e17 26163c2 Author: Prameet Shah Date: Wed Jul 30 16:31:08 2014 +0000 am 26163c26: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() * commit 26163c268a6d2625384b87e907afad8ef19f9a47: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() commit 26163c268a6d2625384b87e907afad8ef19f9a47 Author: Prameet Shah Date: Tue Jul 29 16:45:31 2014 Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() Bug: Change-Id: I5bcaf3ee8910ff75e785baed4c4604fee6c5e700 commit b389e1779651f2c58454a5f98acebd3dd7bc0061 Merge: 5f03b4d e427972 Author: Prameet Shah Date: Thu Jul 24 19:46:28 2014 +0000 am e427972e: OpenSSLEngineImpl: fix unwrap behavior with array * commit e427972eb6141cd67e6d4c9607863a8d990e6be6: OpenSSLEngineImpl: fix unwrap behavior with array commit 5f03b4d63c7632581b032879de791dc82f05ffa0 Merge: 3d935ee 41eb5b6 Author: Prameet Shah Date: Tue Jul 22 19:26:41 2014 +0000 am 41eb5b65: OpenSSLEngineImpl: fix unwrap behavior with array * commit 41eb5b65e524d01e28da474bd37e4349b12fb494: OpenSSLEngineImpl: fix unwrap behavior with array commit 41eb5b65e524d01e28da474bd37e4349b12fb494 Author: Prameet Shah Date: Tue Jul 22 11:50:18 2014 OpenSSLEngineImpl: fix unwrap behavior with array The decrypted bytes should written sequentially into each buffer of the destination array until its full before moving to the next buffer. Change-Id: I2454249c167deafde6c12134d3c8cd658cd7c21b commit 3d935eeca25e00b56cfd8d37a657c7b2986889b3 Merge: 0a36f6c affd45a Author: Alex Klyubin Date: Fri Jul 18 00:32:14 2014 +0000 am affd45a4: Merge ""Improve the Javadoc of PSKKeyManager."" into lmp-dev * commit affd45a413cf844dad797ad4972074efb9de43d8: Improve the Javadoc of PSKKeyManager. commit 0a36f6c1f8b2e195c2dd5aea1a386df090c6d470 Merge: 6492180 af4fa68 Author: rich cannings Date: Thu Jul 17 23:47:33 2014 +0000 am af4fa685: Merge ""Log CCS exceptions do not merge."" into lmp-dev * commit af4fa685f246aaa80c93af62faadbc2fe87dc034: Log CCS exceptions do not merge. commit 6492180ce17a3b5ff822cff1783f00e7a4176491 Merge: aac4168 3b7268c Author: Alex Klyubin Date: Thu Jul 17 18:27:39 2014 +0000 am 3b7268cd: Merge ""Improve the Javadoc of PSKKeyManager."" * commit 3b7268cde4a4fc59591da8a93691927ebf3add57: Improve the Javadoc of PSKKeyManager. commit aac4168d8baef7e12d6fa959c6d6ded9892e9651 Merge: 8573ad0 a749c0d Author: Kenny Root Date: Thu Jul 17 17:07:05 2014 +0000 am a749c0d3: Keep enough state to completely reset cipher instances * commit a749c0d351216be38879600ee8ed01c6793aa256: Keep enough state to completely reset cipher instances commit 8573ad0ddcf7e2f8b2e5ac84c34b7ffab303155c Merge: 4ca5b06 70fdb6d Author: Koushik Dutta Date: Thu Jul 17 17:06:36 2014 +0000 am 70fdb6d2: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. * commit 70fdb6d2bfa0c313fe389827f0025288f6aeb947: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. commit 4ca5b0625e3f5a15ae8adf833ab5a69f9d7d517f Merge: 119abfb ded66f5 Author: Koushik Dutta Date: Thu Jul 17 17:06:35 2014 +0000 am ded66f5f: Various fixes in OpenSSLEngineImpl. * commit ded66f5f696994ce7620552e16a4e9124e69e052: Various fixes in OpenSSLEngineImpl. commit 119abfba1fcd9c9cfbd15d0a4ca9ed2188fdfab0 Merge: 5713cdf cbe1f28 Author: Kenny Root Date: Thu Jul 17 15:56:57 2014 +0000 am cbe1f28a: Merge ""Keep enough state to completely reset cipher instances"" * commit cbe1f28adf64396561a3b65bf1452dfa9b6e35ae: Keep enough state to completely reset cipher instances commit cbe1f28adf64396561a3b65bf1452dfa9b6e35ae Merge: e08f238 084e308 Author: Kenny Root Date: Thu Jul 17 15:48:58 2014 +0000 Merge ""Keep enough state to completely reset cipher instances"" commit 3b7268cde4a4fc59591da8a93691927ebf3add57 Merge: cbe1f28 7ac13e0 Author: Alex Klyubin Date: Thu Jul 17 18:20:43 2014 +0000 Merge ""Improve the Javadoc of PSKKeyManager."" commit 5713cdf71c5c6e5179e8369263c702e9512afdd0 Merge: cf55719 e08f238 Author: Koushik Dutta Date: Wed Jul 16 22:05:17 2014 +0000 am e08f2385: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. * commit e08f238580e8ee471012bef8240c8d3397c7b780: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. commit cf557195a9b60d7f51a48500afde38481ddbc91c Merge: cbbd7d1 986aeb7 Author: Kenny Root Date: Wed Jul 16 21:41:12 2014 +0000 am 986aeb78: Merge ""Various fixes in OpenSSLEngineImpl."" * commit 986aeb78e533540463daf1753e24840f75b25ce6: Various fixes in OpenSSLEngineImpl. commit e08f238580e8ee471012bef8240c8d3397c7b780 Author: Koushik Dutta Date: Tue Jul 15 22:40:23 2014 OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. Change-Id: Idc78204b7077fb367b64e1867c807cd39f596f98 commit 7ac13e03a79d0c99d181b1a28b1b3699ba3d5739 Author: Alex Klyubin Date: Wed Jul 16 08:33:02 2014 Improve the Javadoc of PSKKeyManager. This clarifies several points and adds sample code. Bug: 15073623 Change-Id: I6e8aadc52277e238a998d6cee36795dab1151d58 commit 986aeb78e533540463daf1753e24840f75b25ce6 Merge: 8f9ac1a bdfcc18 Author: Kenny Root Date: Wed Jul 16 21:15:30 2014 +0000 Merge ""Various fixes in OpenSSLEngineImpl."" commit bdfcc189efe41a3f812aeb55ea634bace67d159a Author: Koushik Dutta Date: Sat Jun 28 19:19:21 2014 Various fixes in OpenSSLEngineImpl. Fix ""Buffers were not large enough"" exception by directly using the destination buffers. Corrections around bytesProduced and bytesConsumed behavior. Return BUFFER_OVERFLOW if a zero length destination is provided to unwrap. Change-Id: I1f1e9b72cd6968ed4f3c3c0edccbccebc33d6790 commit cbbd7d10e8e484c44a78e5b27e8fecda195f1692 Merge: ec7f8e6 fdb7d8c Author: Alex Klyubin Date: Tue Jul 15 18:49:14 2014 +0000 am fdb7d8c5: Enable PSK cipher suites when PSKKeyManager is provided. * commit fdb7d8c53dabac5551e2499d045ba6829bcfc0a0: Enable PSK cipher suites when PSKKeyManager is provided. commit ec7f8e6b27330160f88540f4f2ace7bc2a0720a3 Merge: 5b8ccf1 8f9ac1a Author: Alex Klyubin Date: Tue Jul 15 15:53:46 2014 +0000 am 8f9ac1af: Enable PSK cipher suites when PSKKeyManager is provided. * commit 8f9ac1af0cbdf00e5e47aee32c132522ebc3bd17: Enable PSK cipher suites when PSKKeyManager is provided. commit 5b8ccf1b09df6f35c1709bfc8fd727a291094a5b Merge: 69a2e46 6e2315f Author: Ed Heyl Date: Tue Jul 15 13:34:25 2014 +0000 am 6e2315fd: reconcile aosp (e79c25bf33e10da41e489c537823f678e1a1169c) after branching. Please do not merge. * commit 6e2315fd96c3c4a47450c1a437babacc94bc31a6: reconcile aosp (e79c25bf33e10da41e489c537823f678e1a1169c) after branching. Please do not merge. commit 084e3086be1d7a6b9280b64c7c8cdb7b41a13bea Author: Kenny Root Date: Mon Jul 14 13:25:32 2014 Keep enough state to completely reset cipher instances OpenSSLs RC4 mutates the given key. AES/CTR mutates the IV. We must store these values locally to enable ""doFinal"" to cause the Cipher instance to be reset to what it was right after ""init"". Note that resetting and encrypting with the same key or IV breaks semantic security. Bug: 16298401 Bug: Change-Id: Ie7e4dcb6cf6cc33ddad31d6b47066dc1b34e6894 commit 69a2e460cc0a40e1b951e400589b9932609079ec Merge: 8b7bb32 bca895f Author: David Benjamin Date: Mon Jul 14 18:17:28 2014 +0000 am bca895f8: Pass output buffer length into EVP_DigestSignFinal. * commit bca895f809dd2cef7a0834f0bfeb2a06e42b277d: Pass output buffer length into EVP_DigestSignFinal. commit 8b7bb32af09a01e80442b70dd23e6997a937f103 Merge: a2404c9 e79c25b Author: Kenny Root Date: Mon Jul 14 18:17:28 2014 +0000 am e79c25bf: Merge ""DHKeyPairGenerator: use provided params"" * commit e79c25bf33e10da41e489c537823f678e1a1169c: DHKeyPairGenerator: use provided params commit 8f9ac1af0cbdf00e5e47aee32c132522ebc3bd17 Author: Alex Klyubin Date: Thu Jun 19 13:37:24 2014 Enable PSK cipher suites when PSKKeyManager is"
,,0.1981,conscrypt,"Allow conscrypt to work with BoringSSL. This is quite a substantial change because of the changes to ENGINEs in BoringSSL. For the most part, are used to allow the code to work with either OpenSSL or BoringSSL. However, in several places, support for things that BoringSSL is dropping have been removed, even when OpenSSL is used. This includes DSA keys and tests for the ENGINE bits that are going away because its unclear how to skip compiling those tests. Change-Id: I941a5ed232391f84b45e070c19d2ffb7ad162b7b/"
,,0.1509,conscrypt,"Convert EVP_PKEY to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. This pass fixes EVP_PKEY references, but more passes are needed. Bug: 16656908 Change-Id: I5925da40cb37cd328b3a126404944f771732a43e/"
,,0.1454,conscrypt,"Convert EVP_PKEY to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. This pass fixes EVP_PKEY references, but more passes are needed. Bug: 16656908 Change-Id: I5925da40cb37cd328b3a126404944f771732a43e/"
,,0.2522,conscrypt,"Call EVP_CIPHER_CTX_free instead of EVP_CIPHER_CTX_cleanup. The latter doesnt OpenSSL_free memory allocated by EVP_CIPHER_CTX_new. Its worth noting that EVP_CIPHER_CTX_free doesnt check the return value of EVP_CIPHER_CTX_cleanup so we cant throw if cleanup failed, but we were only ever calling this method from a finalizer anyway. (cherry picked from commit c64652932d8e17ccf7e54c0c76c1b38a86841732) bug: 18617384 Change-Id: Ida65e14ffbed41f56a59e2f5fe77289cac0f5947/Convert EC_GROUP and EC_POINT to new style Bug: 16656908 Change-Id: Ie912f376f69327ce634cac50763bf86b418049f5/Switch EVP_CIPHER_CTX to new style Bug: 16656908 Change-Id: Id519c20474a02c70e72d362bc84d26855a74fa33/Convert EVP_PKEY to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. This pass fixes EVP_PKEY references, but more passes are needed. Bug: 16656908 Change-Id: I5925da40cb37cd328b3a126404944f771732a43e/Convert EVP_MD_CTX to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. Bug: 16656908 Change-Id: I165e041a8fe056770d6ce6d6cd064c411575b7c4/Clean up unused variables Change-Id: I9234e649a910408cff9f9d33008642e0c8334276/Track upgrade to OpenSSL 1.0.1j Bug: 18018599 Change-Id: I2b8c62190a9dd5e5fdc6894334cf1d3edfce0a06/Remove SSLv3 from default protocols list for TLS SSLv3 has some systemic problems demonstrated by the POODLE attack. Disable it by default when ""TLS"" is requested since the documentation in Java Standard Names allows us to not support SSL when TLS is requested. Bug: 17136008 Change-Id: Icad1639c7e33b6e495f452a5289b0d20b819d679/"
,,0.0588,conscrypt,Switch EVP_CIPHER_CTX to new style Bug: 16656908 Change-Id: Id519c20474a02c70e72d362bc84d26855a74fa33/
,,0.1509,conscrypt,"Convert EVP_PKEY to new style To avoid conflicts in the language spec and how Conscrypt does native calls, we need to wrap all native references in a Java object reference. Calling NativeCryptos static native methods with a raw pointer doesnt guarantee that the calling object wont be finalized during the method running. This pass fixes EVP_PKEY references, but more passes are needed. Bug: 16656908 Change-Id: I5925da40cb37cd328b3a126404944f771732a43e/"
,,0.14800000000000002,conscrypt,"OpenSSLEngineImpl: return bytes consumed for unwrap During a handshake, unwrap should return the number of bytes consumed by the SSL implementation in addition to changing the source buffer position so that the client can alter its state based on either. Bug: 18921387 Bug: Change-Id: Idf5a3b24c8ad053ef2970bfb66d142a7c2685c02/Return BUFFER_UNDERFLOW if no source bytes were consumed. ... either during the handshake or after. With this change, were backward compatible with older versions of android. Note that newer versions of apache-http rely on this behaviour. bug: 18554122 (cherry picked from commit 6a1b7a85dcdeb19305ad5153579bd11c1eb0bfad) Change-Id: I741d2585548b3d72abae2b696eee2a186e58414c/Return BUFFER_UNDERFLOW if no source bytes were consumed. ... either during the handshake or after. With this change, were backward compatible with older versions of android. Note that newer versions of apache-http rely on this behaviour. bug: 18554122 Change-Id: I574c263e8df4a5f2396ac860608fe85cdbcdbb49/Fix SSLEngine to support session resumption. (cherry picked from commit cd50afad1567b1311e6e979e94a7167b7bf69c94) Bug: 17877118 Change-Id: I388b59cde58fdc506ecac9f536e4bbd9161df6ad/"
,,0.8206,conscrypt,"Fix OpenSSLSocketImpl.getPort when SNI is used. We were using a non-null hostname as a hint that the socket was constructed with an explicit host and port. This is no longer true because the hostname can be non-null when SNI is used (i.e setHostname is called with a non-null hostname). bug: 18428603 (cherry picked from commit 131640979c0ba3f18581cee9bf5c925ec8a7372b) Change-Id: I5a76a17259e4f50a0b8a29b37a647265a755e326/Squashed commit of changes from lmp-ub-dev Contains the following changes: commit e31d982cdb0f8e6ef05d1e412576888015e1da17 Merge: eaebc54 b73be72 Author: Neil Fuller Date: Wed Oct 22 10:34:23 2014 +0000 am b73be72e: am 3e21a289: (-s ours) TLS_FALLBACK_SCSV CTS fix for klp-modular-dev * commit b73be72ed97da8f36450d95d52f485cc6f451c61: TLS_FALLBACK_SCSV CTS fix for klp-modular-dev commit eaebc544f3a10c53d7d2f908514122caba569e14 Merge: 223b5da cd50afa Author: Kenny Root Date: Tue Oct 14 17:30:19 2014 +0000 Merge ""Fix SSLEngine to support session resumption."" into lmp-ub-dev commit 223b5da5d70e47b1a497e86474493925b568f6d7 Merge: 8737796 cb7a360 Author: Neil Fuller Date: Thu Oct 9 14:52:00 2014 +0000 am cb7a3605: am ea961ada: Apply conscrypt changes from merge commit * commit cb7a36050f34d3c16be00d532411820761eeb276: Apply conscrypt changes from merge commit commit cd50afad1567b1311e6e979e94a7167b7bf69c94 Author: Doug Steedman Date: Mon Oct 6 13:16:15 2014 Fix SSLEngine to support session resumption. Bug: 17877118 Change-Id: I388b59cde58fdc506ecac9f536e4bbd9161df6ad commit 8737796a646eaec94df32827752a71aee74bd46f Merge: 9564a5f 8d7e23e Author: Kenny Root Date: Mon Oct 6 22:34:20 2014 +0000 am 8d7e23e1: Add support for TLS_FALLBACK_SCSV * commit 8d7e23e117da591a8d48e6bcda9ed6f58ff1a375: Add support for TLS_FALLBACK_SCSV commit 9564a5fb9ed2eecf6299788db35213cb08397212 Merge: 4f58feb 7640613 Author: Kenny Root Date: Fri Sep 12 17:27:23 2014 +0000 am 76406135: am 6dcb23fe: am f427ec90: Fix the ENGINE_finish/ENGINE_free mixup * commit 76406135cf3a3b88afc979fe8e847b9c3d8b93c1: Fix the ENGINE_finish/ENGINE_free mixup commit 4f58feb0ea49dc089a95efba196032ef3c960a39 Merge: ddac5c6 984b7ec Author: Kenny Root Date: Wed Sep 10 07:07:16 2014 +0000 am 984b7ec6: Fix the ENGINE_finish/ENGINE_free mixup * commit 984b7ec6f5aab314117949a48e448ff4f6b65f16: Fix the ENGINE_finish/ENGINE_free mixup commit ddac5c6d7e413b0d68b388fbdf70dbeb3eeae865 Merge: 5a8ca5b 36ba60b Author: Kenny Root Date: Thu Sep 4 22:41:38 2014 +0000 Merge ""Reset lmp-ub-dev to lmp-dev-plus-aosp"" into lmp-ub-dev commit 36ba60b039f1f30ab1ea8f0e2a4da8ae4e3906e5 Author: Kenny Root Date: Wed Aug 27 12:07:07 2014 Reset lmp-ub-dev to lmp-dev-plus-aosp Bug: 17059757 Change-Id: I581963360da47b574e1e2e20c2851485c36fa62c commit 6a4f2ef9e4ea3ebb321d45ca39b30d634ea3b4ad Merge: 9b187af f67d784 Author: Kenny Root Date: Tue Aug 26 04:17:38 2014 +0000 am f67d784a: Add pre-Honeycomb literal IP matching * commit f67d784abe5cef700240be02c68cecd899cd8e6d: Add pre-Honeycomb literal IP matching commit 9b187af33dcd97915a0371d64fe1ee4aba20d0ba Merge: 714ebea 966ae8a Author: Kenny Root Date: Tue Aug 26 04:17:37 2014 +0000 am 966ae8a6: Read property to enable SNI * commit 966ae8a6e12f3235b1cb041e687bda11b41fe4eb: Read property to enable SNI commit 714ebeabcb5e35c6df6a5c21f549cdb6130368c4 Merge: 7724204 54a1ba4 Author: Kenny Root Date: Tue Aug 26 04:06:54 2014 +0000 Merge ""resolved conflicts for merge of 342097db to lmp-dev-plus-aosp"" into lmp-dev-plus-aosp commit 54a1ba421d23bb6d988688c2662715e509172447 Merge: a20d871 342097d Author: Kenny Root Date: Mon Aug 25 21:03:51 2014 resolved conflicts for merge of 342097db to lmp-dev-plus-aosp Change-Id: I853c6b0d3725dafbdc84c4d6d6d1b90529bd949d commit 7724204abf4431d35787c44c4a22cda5489d4e37 Merge: 20f60ac afb3403 Author: Kenny Root Date: Tue Aug 26 00:09:27 2014 +0000 am afb34034: Implement write socket timeouts for unbundled apps * commit afb340348bfc54dbc46964e159fe803f9c93a4dd: Implement write socket timeouts for unbundled apps commit f67d784abe5cef700240be02c68cecd899cd8e6d Author: Kenny Root Date: Wed Aug 20 14:14:26 2014 Add pre-Honeycomb literal IP matching This will allow us to run this code on Gingerbread devices and others that dont have the InetAddress#isNumeric API. Bug: 16658420 Bug: 17059757 Change-Id: I597d539979d58eeaa2677d6f99e911313a550cc1 commit 966ae8a6e12f3235b1cb041e687bda11b41fe4eb Author: Kenny Root Date: Mon Aug 18 10:12:20 2014 Read property to enable SNI Read the system property ""jsse.enableSNIExtension"" on whether to enable Server Name Indication (SNI) extension. For unbundled builds, this will be enabled by default. For platform builds, this will be disabled by default. Bug: 16658420 Bug: 17059757 Change-Id: I774f5406bf3fe601a42c4ef5e708b31800147eb9 commit 342097db97a9b2736531033b2c4b4d8ce4998c67 Author: Kenny Root Date: Wed Aug 20 12:14:52 2014 Validate hostname is usable for SNI According to RFC 6066 section 3, the hostname listed in the Server Name Indication (SNI) field is a fully qualified domain name and IP addresses are not permitted. Bug: 16658420 Bug: 17059757 Change-Id: I804e46b6e66599b2770f0f4f0534467987e51208 commit afb340348bfc54dbc46964e159fe803f9c93a4dd Author: Kenny Root Date: Tue Aug 19 16:33:07 2014 Implement write socket timeouts for unbundled apps Change-Id: I4fd604f057ba4288d4f31bf6b3b93307376023d5 commit 20f60acea153dfdf0c8f75a53d7bd9edb4c7614c Author: Kenny Root Date: Mon Aug 25 11:52:05 2014 Tracking change from AOSP Change-Id: I889af3f7c1de9ef34d9328339e1b421651055ad4 commit 68056b7c9db8a9fb384bbadfc5287730f996896d Merge: 8239dfd cc2ef2e Author: Kenny Root Date: Mon Aug 25 18:03:27 2014 +0000 am cc2ef2e2: Rename hostname fields and methods to reflect usage * commit cc2ef2e2e9ee64f2e0ac2abc7fdf636e2f81fa5e: Rename hostname fields and methods to reflect usage commit 8239dfdcc40a69255d7b2feced960d574ea36321 Merge: e9cf759 076138f Author: Kenny Root Date: Thu Aug 21 16:36:24 2014 +0000 am 076138ff: Use consistent naming for SSLSocket arguments * commit 076138ff29d805ec5a32d6ad96a18ef08c7f1b11: Use consistent naming for SSLSocket arguments commit cc2ef2e2e9ee64f2e0ac2abc7fdf636e2f81fa5e Author: Kenny Root Date: Wed Aug 20 11:26:33 2014 Rename hostname fields and methods to reflect usage The hostname that was supplied when the socket was created is stored as the ""peerHostname"" This is the only one that should be used for Server Name Indication (SNI) purposes. The ""peerHostname"" or the resolved IP address may be used for certificate validation, so keep the use of ""getHostname()"" for cerificate validation. Bug: 16658420 Bug: 17059757 Change-Id: Ifd87dead44fb2f00bbfd5eac7e69fb3fc98e94b4 commit 076138ff29d805ec5a32d6ad96a18ef08c7f1b11 Author: Kenny Root Date: Wed Aug 20 11:24:41 2014 Use consistent naming for SSLSocket arguments This changes all the host to be hostname and anything that takes an InetAddress will have the name of address to avoid confusing it with a hostname. Bug: 16658420 Bug: 17059757 Change-Id: Iac0628d2d156023dbb80c2e636af6bfe63f46650 commit e9cf759ac89fb053c01f1db19931beb14a823618 Merge: ababdd1 7ed0fae Author: Kenny Root Date: Tue Aug 19 19:32:43 2014 +0000 am 7ed0fae1: OpenSSLEngineImpl: reduce number of copies needed * commit 7ed0fae1906061766d0042e69ccba20e4a702bbe: OpenSSLEngineImpl: reduce number of copies needed commit 7ed0fae1906061766d0042e69ccba20e4a702bbe Author: Kenny Root Date: Tue Jul 22 13:03:09 2014 OpenSSLEngineImpl: reduce number of copies needed When the ByteBuffer didnt line up exactly with the backing array, it would allocate a new buffer to write into. Instead, add the ability for OpenSSL to read at an offset in the given array so a copy isnt needed. Change-Id: I149d3f94e4b5cbdc010df80439ae3300cbdc87a5 commit ababdd1ae1272eac174e3a449a413ab35afbc435 Merge: 66c31e0 4b050b6 Author: Kenny Root Date: Fri Aug 15 16:23:14 2014 +0000 am 4b050b6f: OpenSSLSocketImpl: Move state checks inside mutex * commit 4b050b6fb06fbb804557eecc72cc4ff0e0277525: OpenSSLSocketImpl: Move state checks inside mutex commit 66c31e0b613ceefc167a2e1fb226a14c78f84537 Merge: f4b895a 0931d51 Author: Kenny Root Date: Thu Aug 14 20:46:43 2014 +0000 am 0931d51c: OpenSSLSocketImpl: Move state checks inside mutex * commit 0931d51c58b2dc2f612298f99fbf0fa6ed4c3706: OpenSSLSocketImpl: Move state checks inside mutex commit 0931d51c58b2dc2f612298f99fbf0fa6ed4c3706 Author: Kenny Root Date: Tue Aug 5 15:45:32 2014 OpenSSLSocketImpl: Move state checks inside mutex Checking the state of the connection is unreliable if SSL_read and SSL_write are happening in another thread. Move the state checks inside our application mutex so we dont run into another thread mutating the state at the same time. Bug: 15606096 Change-Id: I5ecdeb1551a13098d1b66c5e4009607c9951fa38 commit f4b895ae9c424b5c2d49c744131606adccbc49d7 Merge: a35c400 a260ee6 Author: Kenny Root Date: Wed Aug 13 15:35:28 2014 +0000 am a260ee6d: Revert ""Revert ""Automatic management of OpenSSL error stack"""" * commit a260ee6d0caea43f8010f158a4a35fb712935ae3: Revert ""Revert ""Automatic management of OpenSSL error stack"""" commit a35c40017c8690f821351d6460dfeaa2738b884c Merge: 0edc483 30550a8 Author: Kenny Root Date: Wed Aug 13 15:35:27 2014 +0000 am 30550a8b: Fix debugging with unbundled conscrypt * commit 30550a8b64bbcd6ca537680a17b8726932a29937: Fix debugging with unbundled conscrypt commit a260ee6d0caea43f8010f158a4a35fb712935ae3 Author: Kenny Root Date: Tue Aug 12 15:38:10 2014 Revert ""Revert ""Automatic management of OpenSSL error stack"""" The ""else"" statement in OpenSslError::reset wasnt properly resetting the error state which made a second call into sslRead jump into sslSelect when it should have just returned immediately. Change-Id: I22e8025c0497a04e78daa07cef78191a6ca1a70c commit 30550a8b64bbcd6ca537680a17b8726932a29937 Author: Kenny Root Date: Tue Aug 12 15:13:33 2014 Fix debugging with unbundled conscrypt When JNI_TRACE was enabled, there were missing defines for the debugging code since no platform code is included. Also clang complains about more of the debugging statement formats, so we have to move some things around to get it to be happy. Change-Id: I1a6695c2ef2639cc01cfc3d3a8603f010c659844 commit 0edc4833091846d6cb45961fc9458df842fbbad9 Merge: 107a8fb 2411b8b Author: Kenny Root Date: Tue Aug 12 21:46:12 2014 +0000 am 2411b8bd: Merge ""Revert ""Automatic management of OpenSSL error stack"""" * commit 2411b8bdcde72c956f4150e9a5909b7501f50bad: Revert ""Automatic management of OpenSSL error stack"" commit 2411b8bdcde72c956f4150e9a5909b7501f50bad Merge: 3262a8c b514d72 Author: Kenny Root Date: Tue Aug 12 21:39:32 2014 +0000 Merge ""Revert ""Automatic management of OpenSSL error stack"""" commit b514d72b93c3996d97e38eca6db1ad684965fd9b Author: Kenny Root Date: Tue Aug 12 21:39:17 2014 +0000 Revert ""Automatic management of OpenSSL error stack"" This reverts commit 35666e4cb0fcd063a21d17eebbb571b4e4e822b8. Change-Id: I926d159c4c4b99250caef750732976c1e601e9ef commit 107a8fba8be5be57933f2638b76ac1243b578b9e Merge: 1de007f 3262a8c Author: Kenny Root Date: Tue Aug 12 15:50:14 2014 +0000 am 3262a8c2: Merge ""Automatic management of OpenSSL error stack"" * commit 3262a8c2741b95103149bcdefe2409c24bfddee9: Automatic management of OpenSSL error stack commit 1de007f9f01be8f07a56235dd924c897088a03cb Merge: 94890ae d1bbcd0 Author: Kenny Root Date: Tue Aug 12 15:50:14 2014 +0000 am d1bbcd0e: Relax checks for key vs cert for wrapped keys * commit d1bbcd0ec973e1b8465c204c13b4925fd86e6484: Relax checks for key vs cert for wrapped keys commit 3262a8c2741b95103149bcdefe2409c24bfddee9 Merge: d1bbcd0 35666e4 Author: Kenny Root Date: Tue Aug 12 15:31:02 2014 +0000 Merge ""Automatic management of OpenSSL error stack"" commit d1bbcd0ec973e1b8465c204c13b4925fd86e6484 Author: Kenny Root Date: Mon Aug 11 14:56:58 2014 Relax checks for key vs cert for wrapped keys If a key is a wrapped platform key, we must relax the check. The reason is that we may not have the public values we need to pass the EVP_PKEY_cmp checks that this does. Change-Id: I7ab2be51b0968a9cf771edea01d33fe2367c8185 commit 35666e4cb0fcd063a21d17eebbb571b4e4e822b8 Author: Kenny Root Date: Tue Aug 5 11:05:00 2014 Automatic management of OpenSSL error stack This removes some complexity in remembering to free the OpenSSL error stack. If you forget, the error will stick around until you make another call. Change-Id: I245a525dcc93077b2bf9909a14a0ef469a2daca4 commit 94890aec5735cde2ea5170fb76cd1b847ea66af8 Merge: 8360485 977f087 Author: Kenny Root Date: Tue Aug 5 16:44:42 2014 +0000 am 977f0877: Fix some JNI_TRACE lines * commit 977f08774c628b4640d5454cde050259856965f8: Fix some JNI_TRACE lines commit 977f08774c628b4640d5454cde050259856965f8 Author: Kenny Root Date: Mon Aug 4 12:15:04 2014 Fix some JNI_TRACE lines During debugging these would be enabled, but they were copy-pastad to with the wrong args. Change-Id: I23f39ff4807e3fa71f3220912aec3c99db6b9454 commit 83604854c5160304cafefc9bd40a72c5ee8506eb Merge: 7db3524 1ffe43e Author: Zoltan Szatmary-Ban Date: Thu Jul 31 13:28:57 2014 +0000 am 1ffe43e8: Merge ""Add possibility to get deleted system Certificate Aliases"" into lmp-dev * commit 1ffe43e8277e883c6663c1fb7cfc5e18ba552c40: Add possibility to get deleted system Certificate Aliases commit 7db3524880092126962b7f502af76b4c84da7350 Merge: 5767d63 ad0cd83 Author: Prameet Shah Date: Wed Jul 30 17:04:13 2014 +0000 am ad0cd830: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() * commit ad0cd83024f38011043d28d70370a8638b88cd72: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() commit 5767d63d22e87becab387b3bd6597fe41eb34d7e Merge: b389e17 26163c2 Author: Prameet Shah Date: Wed Jul 30 16:31:08 2014 +0000 am 26163c26: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() * commit 26163c268a6d2625384b87e907afad8ef19f9a47: Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() commit 26163c268a6d2625384b87e907afad8ef19f9a47 Author: Prameet Shah Date: Tue Jul 29 16:45:31 2014 Added CLOSED_INBOUND and CLOSED_OUTBOUND states to OpenSSLEngineImpl#getHandshakeStatus() Bug: Change-Id: I5bcaf3ee8910ff75e785baed4c4604fee6c5e700 commit b389e1779651f2c58454a5f98acebd3dd7bc0061 Merge: 5f03b4d e427972 Author: Prameet Shah Date: Thu Jul 24 19:46:28 2014 +0000 am e427972e: OpenSSLEngineImpl: fix unwrap behavior with array * commit e427972eb6141cd67e6d4c9607863a8d990e6be6: OpenSSLEngineImpl: fix unwrap behavior with array commit 5f03b4d63c7632581b032879de791dc82f05ffa0 Merge: 3d935ee 41eb5b6 Author: Prameet Shah Date: Tue Jul 22 19:26:41 2014 +0000 am 41eb5b65: OpenSSLEngineImpl: fix unwrap behavior with array * commit 41eb5b65e524d01e28da474bd37e4349b12fb494: OpenSSLEngineImpl: fix unwrap behavior with array commit 41eb5b65e524d01e28da474bd37e4349b12fb494 Author: Prameet Shah Date: Tue Jul 22 11:50:18 2014 OpenSSLEngineImpl: fix unwrap behavior with array The decrypted bytes should written sequentially into each buffer of the destination array until its full before moving to the next buffer. Change-Id: I2454249c167deafde6c12134d3c8cd658cd7c21b commit 3d935eeca25e00b56cfd8d37a657c7b2986889b3 Merge: 0a36f6c affd45a Author: Alex Klyubin Date: Fri Jul 18 00:32:14 2014 +0000 am affd45a4: Merge ""Improve the Javadoc of PSKKeyManager."" into lmp-dev * commit affd45a413cf844dad797ad4972074efb9de43d8: Improve the Javadoc of PSKKeyManager. commit 0a36f6c1f8b2e195c2dd5aea1a386df090c6d470 Merge: 6492180 af4fa68 Author: rich cannings Date: Thu Jul 17 23:47:33 2014 +0000 am af4fa685: Merge ""Log CCS exceptions do not merge."" into lmp-dev * commit af4fa685f246aaa80c93af62faadbc2fe87dc034: Log CCS exceptions do not merge. commit 6492180ce17a3b5ff822cff1783f00e7a4176491 Merge: aac4168 3b7268c Author: Alex Klyubin Date: Thu Jul 17 18:27:39 2014 +0000 am 3b7268cd: Merge ""Improve the Javadoc of PSKKeyManager."" * commit 3b7268cde4a4fc59591da8a93691927ebf3add57: Improve the Javadoc of PSKKeyManager. commit aac4168d8baef7e12d6fa959c6d6ded9892e9651 Merge: 8573ad0 a749c0d Author: Kenny Root Date: Thu Jul 17 17:07:05 2014 +0000 am a749c0d3: Keep enough state to completely reset cipher instances * commit a749c0d351216be38879600ee8ed01c6793aa256: Keep enough state to completely reset cipher instances commit 8573ad0ddcf7e2f8b2e5ac84c34b7ffab303155c Merge: 4ca5b06 70fdb6d Author: Koushik Dutta Date: Thu Jul 17 17:06:36 2014 +0000 am 70fdb6d2: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. * commit 70fdb6d2bfa0c313fe389827f0025288f6aeb947: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. commit 4ca5b0625e3f5a15ae8adf833ab5a69f9d7d517f Merge: 119abfb ded66f5 Author: Koushik Dutta Date: Thu Jul 17 17:06:35 2014 +0000 am ded66f5f: Various fixes in OpenSSLEngineImpl. * commit ded66f5f696994ce7620552e16a4e9124e69e052: Various fixes in OpenSSLEngineImpl. commit 119abfba1fcd9c9cfbd15d0a4ca9ed2188fdfab0 Merge: 5713cdf cbe1f28 Author: Kenny Root Date: Thu Jul 17 15:56:57 2014 +0000 am cbe1f28a: Merge ""Keep enough state to completely reset cipher instances"" * commit cbe1f28adf64396561a3b65bf1452dfa9b6e35ae: Keep enough state to completely reset cipher instances commit cbe1f28adf64396561a3b65bf1452dfa9b6e35ae Merge: e08f238 084e308 Author: Kenny Root Date: Thu Jul 17 15:48:58 2014 +0000 Merge ""Keep enough state to completely reset cipher instances"" commit 3b7268cde4a4fc59591da8a93691927ebf3add57 Merge: cbe1f28 7ac13e0 Author: Alex Klyubin Date: Thu Jul 17 18:20:43 2014 +0000 Merge ""Improve the Javadoc of PSKKeyManager."" commit 5713cdf71c5c6e5179e8369263c702e9512afdd0 Merge: cf55719 e08f238 Author: Koushik Dutta Date: Wed Jul 16 22:05:17 2014 +0000 am e08f2385: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. * commit e08f238580e8ee471012bef8240c8d3397c7b780: OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. commit cf557195a9b60d7f51a48500afde38481ddbc91c Merge: cbbd7d1 986aeb7 Author: Kenny Root Date: Wed Jul 16 21:41:12 2014 +0000 am 986aeb78: Merge ""Various fixes in OpenSSLEngineImpl."" * commit 986aeb78e533540463daf1753e24840f75b25ce6: Various fixes in OpenSSLEngineImpl. commit e08f238580e8ee471012bef8240c8d3397c7b780 Author: Koushik Dutta Date: Tue Jul 15 22:40:23 2014 OpenSSLEngine Impl: Fix bug where SSL Handshake never completes when using NPN. Change-Id: Idc78204b7077fb367b64e1867c807cd39f596f98 commit 7ac13e03a79d0c99d181b1a28b1b3699ba3d5739 Author: Alex Klyubin Date: Wed Jul 16 08:33:02 2014 Improve the Javadoc of PSKKeyManager. This clarifies several points and adds sample code. Bug: 15073623 Change-Id: I6e8aadc52277e238a998d6cee36795dab1151d58 commit 986aeb78e533540463daf1753e24840f75b25ce6 Merge: 8f9ac1a bdfcc18 Author: Kenny Root Date: Wed Jul 16 21:15:30 2014 +0000 Merge ""Various fixes in OpenSSLEngineImpl."" commit bdfcc189efe41a3f812aeb55ea634bace67d159a Author: Koushik Dutta Date: Sat Jun 28 19:19:21 2014 Various fixes in OpenSSLEngineImpl. Fix ""Buffers were not large enough"" exception by directly using the destination buffers. Corrections around bytesProduced and bytesConsumed behavior. Return BUFFER_OVERFLOW if a zero length destination is provided to unwrap. Change-Id: I1f1e9b72cd6968ed4f3c3c0edccbccebc33d6790 commit cbbd7d10e8e484c44a78e5b27e8fecda195f1692 Merge: ec7f8e6 fdb7d8c Author: Alex Klyubin Date: Tue Jul 15 18:49:14 2014 +0000 am fdb7d8c5: Enable PSK cipher suites when PSKKeyManager is provided. * commit fdb7d8c53dabac5551e2499d045ba6829bcfc0a0: Enable PSK cipher suites when PSKKeyManager is provided. commit ec7f8e6b27330160f88540f4f2ace7bc2a0720a3 Merge: 5b8ccf1 8f9ac1a Author: Alex Klyubin Date: Tue Jul 15 15:53:46 2014 +0000 am 8f9ac1af: Enable PSK cipher suites when PSKKeyManager is provided. * commit 8f9ac1af0cbdf00e5e47aee32c132522ebc3bd17: Enable PSK cipher suites when PSKKeyManager is provided. commit 5b8ccf1b09df6f35c1709bfc8fd727a291094a5b Merge: 69a2e46 6e2315f Author: Ed Heyl Date: Tue Jul 15 13:34:25 2014 +0000 am 6e2315fd: reconcile aosp (e79c25bf33e10da41e489c537823f678e1a1169c) after branching. Please do not merge. * commit 6e2315fd96c3c4a47450c1a437babacc94bc31a6: reconcile aosp (e79c25bf33e10da41e489c537823f678e1a1169c) after branching. Please do not merge. commit 084e3086be1d7a6b9280b64c7c8cdb7b41a13bea Author: Kenny Root Date: Mon Jul 14 13:25:32 2014 Keep enough state to completely reset cipher instances OpenSSLs RC4 mutates the given key. AES/CTR mutates the IV. We must store these values locally to enable ""doFinal"" to cause the Cipher instance to be reset to what it was right after ""init"". Note that resetting and encrypting with the same key or IV breaks semantic security. Bug: 16298401 Bug: Change-Id: Ie7e4dcb6cf6cc33ddad31d6b47066dc1b34e6894 commit 69a2e460cc0a40e1b951e400589b9932609079ec Merge: 8b7bb32 bca895f Author: David Benjamin Date: Mon Jul 14 18:17:28 2014 +0000 am bca895f8: Pass output buffer length into EVP_DigestSignFinal. * commit bca895f809dd2cef7a0834f0bfeb2a06e42b277d: Pass output buffer length into EVP_DigestSignFinal. commit 8b7bb32af09a01e80442b70dd23e6997a937f103 Merge: a2404c9 e79c25b Author: Kenny Root Date: Mon Jul 14 18:17:28 2014 +0000 am e79c25bf: Merge ""DHKeyPairGenerator: use provided params"" * commit e79c25bf33e10da41e489c537823f678e1a1169c: DHKeyPairGenerator: use provided params commit 8f9ac1af0cbdf00e5e47aee32c132522ebc3bd17 Author: Alex Klyubin Date: Thu Jun 19 13:37:24 2014 Enable PSK cipher suites when PSKKeyManager is provided. This enables TLS-PSK cipher suites by default iff SSLContext is initialized with a PSKKeyManager. For consistency, X.509 based cipher suites are no longer enabled by default at all times they are now only enabled by default iff SSLContext is initialized with a X509KeyManager or a X509TrustManager. When both X.509 and PSK cipher suites need to be enabled, PSK cipher suites are given higher priority in the resulting list of cipher suites. This is based on the assumption that in most cases users of TLS/SSL who enable TLS-PSK would prefer TLS-PSK to be used when the peer supports TLS-PSK. Bug: 15073623 Change-Id: I8e2bc3e7a1ea8a986e468973b6bad19dc6b7bc3c commit bca895f809dd2cef7a0834f0bfeb2a06e42b277d Author: David Benjamin Date: Thu Jul 10 18:12:08 2014 Pass output buffer length into EVP_DigestSignFinal. EVP_DigestSignFinal expects the input buffer length as *siglen on input. In addition, if sigret is NULL, it returns the buffer size needed. Use this rather than making assumptions about the EVP_PKEY used to initialize the EVP_MD_CTX. commit e79c25bf33e10da41e489c537823f678e1a1169c Merge: a328492 9b226f9 Author: Kenny Root Date: Fri Jul 11 16:46:23 2014 +0000 Merge ""DHKeyPairGenerator: use provided params"" commit 9b226f90a992a4a2267b7a813e3b869851945c4d Author: Kenny Root Date: Thu Jul 10 14:50:48 2014 DHKeyPairGenerator: use provided params If the prime is provided in the DHParameterSpec, then use it to generate the key. Bug: 16188130 Change-Id: I42de02c71a58d691ef7ba6e2252367105687b758 Bug: 18388980 Change-Id: I853b02a32db113a5af3f6166e7d61fab58c3ff73/"
,,0.1172,conscrypt,Move BlockGuard and CloseGuard to Platform This was causing issues on Gingerbread devices since CloseGuard was not in that release yet. Move them out to Platform so we can filter on release when we decide whether to instantiate or not. Bug: 24607028 Change-Id: Iba0bbb0b878076319ace40f848aa5e307e2c3ad8/
,,0.1118,conscrypt,"Verify certificate transparency on domain for which it is enabled. For the time being, CT is enabled by using Java security properties. This makes it possible to deploy it without updating Androids frameworks through GMSCore. Change-Id: Iff9646b7d80f1386965b2b4f4f46a9d80c780a58/Move BlockGuard and CloseGuard to Platform This was causing issues on Gingerbread devices since CloseGuard was not in that release yet. Move them out to Platform so we can filter on release when we decide whether to instantiate or not. Bug: 24607028 Change-Id: Iba0bbb0b878076319ace40f848aa5e307e2c3ad8/"
,,0.0708,conscrypt,Fix missing CTPolicy argument to TrustManagerImpl() Incorrect merge resolution on my part dropped the constructor argument. Test: run OpenSSLSocketImplTest Change-Id: I9b71782050a59558d49223d398c3ad22847e89a5/ct: Allow configurable policy. The configuration will be hooked up in a following CL Test: ran OpenSSLSocketImplTest Change-Id: Ia9af1564cbe7b37746e2cbfe8c5e9c08eab55c76/
,,0.1667,conscrypt,"Update short buffer handling. (#440) This fixes a number of problems in Conscrypts ciphers when they are given an output buffer that is too small for the output. We didnt specifically handle CIPHER_R_BUFFER_TOO_SMALL errors from BoringSSL, so we threw RuntimeException on encountering them. We should be throwing ShortBufferException. Raw ChaCha20 didnt check for a short buffer at all, so it just passed the arrays down to native code, which could cause crashes or other weird behavior. EVP_AEAD ciphers used update() to only record data that needed to be encrypted and then did the actual encrypting in doFinal(). This combined with our implementation that implements doFinal() as a combination of updateInternal() + doFinalInternal() led to a situation where if the buffer passed to doFinal() was too small, the data would get added to the buffer to be encrypted in updateInternal() and then doFinalInternal() call would fail, which would mean a future call to doFinal() with the same data would end up encrypting that data twice. This call pattern is used by some internal CipherSpi methods from OpenJDK, so you could see it in practice even if the caller did nothing wrong. Also add tests around short buffer handling./Calculate output size ourselves for AES/GCM and ChaCha20. (#438) Since both AES/GCM and ChaCha20 dont have any variance in the length of their AEAD tags, we can just calculate the output length directly rather than making a JNI call. This gives better bounds for the necessary buffer size; in particular, we previously werent factoring in the removal of the tag during decryption, so we always demanded an unnecessarily-long buffer./"
,,0.0556,Frostwire,[android] avoid NPE on SwipeLayout::dispatchTouchEvent. build 327/
,,0.066,Frostwire,[android] not using ThemeUtils in ImageWorker/
,,0.0556,Frostwire,[desktop] com.limegroup.gnutella.gui code formatting/
,,0.071,javacpp,Add `PointerTest.testPointerPointer()` to make sure it works correctly (issue
,,0.0851,pljava,More forgiving getXXX methods on ResultSet with respect to types. Made use of Oid more strict. The Oid class is used instead of int. Moved TypeMap functionality into the Oid class./Added getOid method (needed for ResultSetMetaData)/
,,0.0934,pljava,Fixed bug causing primitive arrays to fail./Improved caching of class./More forgiving getXXX methods on ResultSet with respect to types. Made use of Oid more strict. The Oid class is used instead of int. Moved TypeMap functionality into the Oid class./
,,0.0789,pljava,"From now getWarning throws an exception on a closed statement, according to JDBC specification/"
,,0.0905,pljava,Reinstated Exception traces when log level >= DEBUG1 Merged Invocation and CallContext Cleanup and refactoring/*** empty log message ***/Changes needed in order to compile with 8.0.x/Rewrite of fence mechanism/INDEX_MAX_KEYS now determined using GUC variable max_index_keys Dropped support for CYGWIN since 7.x no longer is supported/Fixed bug that caused crash when initializing using incorrect pljava.classpath/
,,0.0636,pljava,Fixed bug Jar owner in the sqlj.jar_repository table changed type from oid to name./
,,0.0823,pljava,Take off the training wheels./
,,0.0848,pljava,"Use ALLOCSET_*_SIZES macros to create contexts. These macros became available in 9.6 (ea268cd, with a ""back-patch"" appearing in 9.6.0, funnily enough). It becomes /necessary/ to use them in PG 11 (9fa6f00), at least when using AllocSetContextCreate rather than the PG11-new AllocSetContextCreateExtended. Here, just define the macros locally for PG 9.6, and use them unconditionally./"
,,0.0819,realm-java,"Revert ""Revert ""Merge pull request from realm/kg-core-0.87.0"""" This reverts commit suggested a refactoring of the old tracing/logging system./"
,,0.0673,realm-java,Add methods to RealmQuery to support byte arrays (#3285)/
,,0.0903,realm-java,Correctly report Client Reset (#4313)/Using ObjectStore SyncManager & Session (#4214) Using ObjectStores SyncManager & Session/
,,0.0954,realm-java,Returning sessions state (#4821) * Returning sessions state/Fix admin users not connection correctly to ROS (#4760)/
,,0.0731,realm-java,Support offline client reset (#5297) * Exposing a `SyncConfiguration` that allows a user to open the backup Realm after the client reset (#4759)./
,,0.1466,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1446,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1446,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1466,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1103,rocksdb,"[RocksJava] Add compression per level to API Summary: RocksDB offers the possibility to set different compression types on a per level basis. This shall be also available using RocksJava. Test Plan: make rocksdbjava make jtest Reviewers: adamretter, yhchiang, ankgup87 Subscribers: dhruba Differential Revision: Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1446,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1466,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1466,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.1466,rocksdb,"[RocksJava] Final usage correction Summary: Introduced final keyword to parameters with immutable values and classes which should not be derived. Test Plan: make rocksdbjava make jtest Reviewers: yhchiang, adamretter, ankgup87 Subscribers: dhruba Differential Revision:"
,,0.0887,rocksdb,"Revert ""Fix failing Java unit test."" This reverts commit d7ae42b0f89fd25d8aaed28703059889d145596e. This is reverted as auto buld failure. This commit itself doesnt have any problem. Reverting as it depends on the commit to revert./Fix failing Java unit test. Test Plan: sent diff to sdong, passes :) Reviewers: sdong Reviewed By: sdong Subscribers: leveldb, andrewkr, dhruba Differential Revision:"
